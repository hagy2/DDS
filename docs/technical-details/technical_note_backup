## Server backup setup | dds.nohost.me

### Set up large enough storage

- Log in to borgbase.com
- Subscribe to higher tier

### Set up 1pasword CLI

To use 1password in terminal to save my keys generated via command line, and use them as needed via command line.

- Follow instructions here: https://developer.1password.com/docs/cli/get-started/
  
- install via brew `brew install 1password-cli`
  
- Check version using `op --version`
  
  - Result: failed with error `No such file or directory @ dir_s_rmdir - /usr/local/var/homebrew/locks/` & a long key
- Install manually
  
  - Download university 1password-CLI package from: [1Password CLI Release Notes](https://app-updates.agilebits.com/product_history/CLI2) (version 2.32.0)
    
  - Double click package
    
  - Follow GUI (graphical user interface) guidance prompts
    
  - Result: Install successful
    
- Check 1Password settings connect to 1Password-CLI
  

### Find SSH key details in command line

- Found and followed this instruction: [git - How do I access my SSH public key? - Stack Overflow](https://stackoverflow.com/questions/3828164/how-do-i-access-my-ssh-public-key)
  
- Then the SSH portion of this instruction made sense: https://forum.yunohost.org/t/how-to-backup-yunohost-server-on-borgbase-with-borgbackup/15295
  
- Log in to server as root using `su`
  
- Enter any admin account password
  
- Type `ls ~/.ssh/*.pub` to get full list of ssh keys
  
- To open file containing 'public key' type `nano /root/.ssh/id_borg_ed25519.pub`
  
- Check Borg is running, and initialise the repository by typing `systemctl start borg.service`
  
  - Result: error
- Try again with `systemctl start borg.service`
  
  - Result: error message "custom backup step could not get past the 'backup' step"
- Found public key by typing `nano borgbase.pub`
  
  - Copied public key to borgbase backup repo
  - Result: confusing! graphic user interface says borg is running, command line says interactive authentication needed.
- Try editing the repository name to make connection from Borg Backup yunohost app to borgbase
  
  - Typed `ssh://<repo_number>.repo.borgbase.com:22/~/dds`

Several steps after this that I didn't document in real time. Each effort failed. I think it is an SSH permissions issue.
